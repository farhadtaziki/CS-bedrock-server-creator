<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Minecraft Bedrock Server Creator (Demo)</title>
  <style>
    :root{--bg:#0f1724;--card:#0b1220;--accent:#16a34a;--muted:#94a3b8;--glass:rgba(255,255,255,0.03)}
    *{box-sizing:border-box}
    body{margin:0;font-family:Inter,ui-sans-serif,system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial;background:linear-gradient(180deg,#071024 0%,#071824 100%);color:#e6eef8;min-height:100vh}
    .container{max-width:1100px;margin:28px auto;padding:20px}
    header{display:flex;align-items:center;justify-content:space-between;margin-bottom:18px}
    h1{font-size:20px;margin:0}
    .btn{background:var(--accent);color:#022; padding:8px 12px;border-radius:8px;border:none;cursor:pointer;font-weight:600}
    .btn.ghost{background:transparent;border:1px solid rgba(255,255,255,0.06);color:var(--muted)}
    .layout{display:grid;grid-template-columns:260px 1fr;gap:18px}
    aside{background:var(--card);padding:16px;border-radius:12px;min-height:420px}
    main{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));padding:16px;border-radius:12px;min-height:420px}
    .card{background:var(--glass);padding:12px;border-radius:10px;margin-bottom:12px}
    .server-list{display:flex;flex-direction:column;gap:10px}
    .server-item{display:flex;align-items:center;justify-content:space-between;padding:10px;border-radius:8px;background:rgba(255,255,255,0.02)}
    .server-meta{display:flex;flex-direction:column}
    .server-name{font-weight:700}
    .small{font-size:13px;color:var(--muted)}
    .topbar{display:flex;align-items:center;gap:8px}

    /* modal */
    .modal-backdrop{position:fixed;inset:0;background:rgba(2,6,23,0.6);display:none;align-items:center;justify-content:center}
    .modal{width:720px;background:linear-gradient(180deg,#071a28,#03111a);border-radius:12px;padding:18px;border:1px solid rgba(255,255,255,0.03)}
    .field{margin-bottom:10px}
    label{display:block;font-size:13px;color:var(--muted);margin-bottom:6px}
    input[type=text],select,textarea{width:100%;padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:inherit}
    .row{display:flex;gap:10px}
    .row .col{flex:1}
    .hint{font-size:12px;color:var(--muted)}

    /* login */
    .auth{display:flex;flex-direction:column;gap:8px;max-width:320px}
    .link{color:var(--accent);cursor:pointer}

    /* editor */
    .two-col{display:grid;grid-template-columns:1fr 1fr;gap:10px}
    textarea.small{height:120px}
    .npc-list{display:flex;flex-direction:column;gap:8px}
    .npc{padding:8px;border-radius:8px;background:rgba(255,255,255,0.02);display:flex;align-items:center;justify-content:space-between}

    footer{margin-top:14px;color:var(--muted);font-size:13px}

    @media(max-width:880px){.layout{grid-template-columns:1fr}aside{order:2}}
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>Minecraft Bedrock Server Creator — Demo</h1>
      <div class="topbar">
        <div id="user-display" class="small"></div>
        <button id="auth-btn" class="btn">Log In / Sign Up</button>
      </div>
    </header>

    <div class="layout">
      <aside>
        <div class="card">
          <div style="display:flex;justify-content:space-between;align-items:center">
            <div>
              <div class="small">Your servers</div>
              <div id="server-count" style="font-weight:700">0</div>
            </div>
            <button id="create-top" class="btn">Create</button>
          </div>
        </div>

        <div class="card">
          <div class="small">Dashboard</div>
          <div style="margin-top:10px" id="dashboard-links">
            <div class="small"><span class="link" id="open-dashboard">Open Dashboard</span></div>
          </div>
        </div>

        <div class="card">
          <div class="small">Quick actions</div>
          <div style="margin-top:8px;display:flex;flex-direction:column;gap:8px">
            <button id="import-btn" class="btn ghost">Import server JSON</button>
            <button id="export-btn" class="btn ghost">Export all</button>
          </div>
        </div>
      </aside>

      <main>
        <div id="main-area">
          <div class="card">
            <div style="display:flex;justify-content:space-between;align-items:center">
              <div>
                <div style="font-weight:700">Your Server List</div>
                <div class="small">Manage servers you created</div>
              </div>
              <div class="small">Demo uses localStorage only</div>
            </div>
          </div>

          <div id="servers" class="server-list"></div>

          <div id="server-panel" style="display:none" class="card">
            <div style="display:flex;justify-content:space-between;align-items:center">
              <div>
                <div id="panel-name" style="font-weight:700"></div>
                <div id="panel-sub" class="small"></div>
              </div>
              <div style="display:flex;gap:8px;align-items:center">
                <div class="small">ID: <span id="panel-id"></span></div>
                <div class="small">Port: <span id="panel-port"></span></div>
                <button id="start-stop" class="btn">Start</button>
              </div>
            </div>

            <hr style="margin:12px 0;border:0;border-top:1px solid rgba(255,255,255,0.03)" />

            <div style="display:grid;grid-template-columns:1fr 320px;gap:12px">
              <div>
                <div style="font-weight:700;margin-bottom:8px">Server Settings</div>
                <div class="field">
                  <label>Version</label>
                  <select id="panel-version"></select>
                </div>
                <div class="field">
                  <label>Texture Pack (URL or upload)</label>
                  <input id="panel-texture" type="text" placeholder="texture URL or leave blank" />
                </div>

                <div style="margin-top:10px;">
                  <div style="font-weight:700;margin-bottom:6px">NPC GUI Editor</div>
                  <div class="npc-list" id="npc-list"></div>
                  <div style="display:flex;gap:8px;margin-top:8px">
                    <input id="npc-name" placeholder="NPC name" />
                    <button id="add-npc" class="btn ghost">Add NPC</button>
                  </div>
                </div>

                <div style="margin-top:12px">
                  <div style="font-weight:700;margin-bottom:6px">Mods</div>
                  <textarea id="mods-area" class="small" placeholder='Add JSON mod descriptor, one per line'></textarea>
                  <div style="display:flex;gap:8px;margin-top:8px">
                    <button id="save-mods" class="btn">Save Mods</button>
                    <button id="clear-mods" class="btn ghost">Clear Mods</button>
                  </div>
                </div>

                <div style="margin-top:12px">
                  <div style="font-weight:700;margin-bottom:6px">Game Rules & Gamemode</div>
                  <div class="row">
                    <div class="col field"><label>Gamemode</label><select id="gamemode"><option>survival</option><option>creative</option><option>adventure</option></select></div>
                    <div class="col field"><label>Keep Inventory</label><select id="keepinv"><option value="false">false</option><option value="true">true</option></select></div>
                  </div>
                  <div style="margin-top:8px"><button id="save-settings" class="btn">Save Settings</button></div>
                </div>

              </div>

              <div>
                <div style="font-weight:700;margin-bottom:8px">Preview / Logs</div>
                <div id="preview" style="height:260px;overflow:auto;padding:8px;border-radius:8px;background:rgba(255,255,255,0.015)"></div>

                <div style="margin-top:12px">
                  <div style="font-weight:700;margin-bottom:6px">Danger Zone</div>
                  <button id="delete-server" class="btn ghost">Delete Server</button>
                </div>
              </div>
            </div>

          </div>

        </div>

        <footer>Demo: everything is local to your browser. To make real servers you need a backend, a host, and the Bedrock server binary.</footer>
      </main>
    </div>
  </div>

  <!-- Modal for create/login -->
  <div id="modal" class="modal-backdrop">
    <div class="modal">
      <div id="modal-body"></div>
    </div>
  </div>

  <script>
    // Demo frontend-only app using localStorage
    const VERSIONS = ['1.19.70','1.20.0','1.20.10','1.21.0','1.22.0']

    // elements
    const authBtn = document.getElementById('auth-btn')
    const userDisplay = document.getElementById('user-display')
    const modal = document.getElementById('modal')
    const modalBody = document.getElementById('modal-body')
    const createTop = document.getElementById('create-top')
    const serversEl = document.getElementById('servers')
    const serverCount = document.getElementById('server-count')
    const serverPanel = document.getElementById('server-panel')

    // panel elements
    const panelName = document.getElementById('panel-name')
    const panelSub = document.getElementById('panel-sub')
    const panelId = document.getElementById('panel-id')
    const panelPort = document.getElementById('panel-port')
    const panelVersion = document.getElementById('panel-version')
    const panelTexture = document.getElementById('panel-texture')
    const npcList = document.getElementById('npc-list')
    const addNpcBtn = document.getElementById('add-npc')
    const npcNameInput = document.getElementById('npc-name')
    const modsArea = document.getElementById('mods-area')
    const saveModsBtn = document.getElementById('save-mods')
    const clearModsBtn = document.getElementById('clear-mods')
    const startStopBtn = document.getElementById('start-stop')
    const panelPortEl = document.getElementById('panel-port')
    const panelIdEl = document.getElementById('panel-id')
    const preview = document.getElementById('preview')
    const deleteServerBtn = document.getElementById('delete-server')
    const saveSettingsBtn = document.getElementById('save-settings')
    const gamemodeEl = document.getElementById('gamemode')
    const keepInvEl = document.getElementById('keepinv')

    // app state
    let state = {user:null,servers:[],selected:null}

    function loadState(){
      const raw = localStorage.getItem('mbsc_demo')
      if(raw){ try{ state = JSON.parse(raw) }catch(e){ state={user:null,servers:[],selected:null} }}
      renderAuth()
      renderServers()
    }
    function saveState(){ localStorage.setItem('mbsc_demo',JSON.stringify(state)); }

    function renderAuth(){
      if(state.user){ userDisplay.textContent = state.user.username; authBtn.textContent='Log out' }
      else{ userDisplay.textContent=''; authBtn.textContent='Log In / Sign Up' }
    }

    authBtn.addEventListener('click',()=>{
      if(state.user){ state.user=null; saveState(); renderAuth(); renderServers(); hidePanel(); return }
      showModalAuth()
    })

    function showModalAuth(){
      modalBody.innerHTML = `
        <h2>Sign in / Sign up</h2>
        <div class="auth">
          <input id="auth-user" placeholder="username" />
          <input id="auth-pass" placeholder="password" type="password" />
          <div style="display:flex;gap:8px">
            <button id="do-login" class="btn">Log in</button>
            <button id="do-signup" class="btn ghost">Sign up</button>
          </div>
          <div class="small" style="margin-top:8px">This demo stores accounts locally. Username must be unique.</div>
        </div>
      `
      modal.style.display='flex'
      document.getElementById('do-login').addEventListener('click',()=>{
        const u = document.getElementById('auth-user').value.trim()
        const p = document.getElementById('auth-pass').value
        if(!u||!p){ alert('enter username & password') ; return }
        const users = JSON.parse(localStorage.getItem('mbsc_users')||'[]')
        const found = users.find(x=>x.username===u && x.pass===p)
        if(found){ state.user={username:u}; saveState(); modal.style.display='none'; renderAuth(); renderServers(); }
        else alert('invalid credentials')
      })
      document.getElementById('do-signup').addEventListener('click',()=>{
        const u = document.getElementById('auth-user').value.trim()
        const p = document.getElementById('auth-pass').value
        if(!u||!p){ alert('enter username & password'); return }
        const users = JSON.parse(localStorage.getItem('mbsc_users')||'[]')
        if(users.find(x=>x.username===u)){ alert('username taken'); return }
        users.push({username:u,pass:p}); localStorage.setItem('mbsc_users',JSON.stringify(users))
        state.user={username:u}; saveState(); modal.style.display='none'; renderAuth(); renderServers();
      })
    }

    // Create server modal
    createTop.addEventListener('click',()=>{
      if(!state.user){ alert('you must be logged in to create servers'); showModalAuth(); return }
      showModalCreate()
    })

    function showModalCreate(){
      modalBody.innerHTML = `
        <h2>Create a new server</h2>
        <div class="field">
          <label>Version</label>
          <select id="new-version">${VERSIONS.map(v=>`<option>${v}</option>`).join('')}</select>
        </div>
        <div class="field">
          <label>Server name (no spaces)</label>
          <input id="new-name" placeholder="my_server_01" />
          <div class="hint">Shown name (below): <span id="name-preview" style="font-weight:700"></span></div>
        </div>
        <div style="display:flex;gap:8px;margin-top:8px">
          <button id="create-server-btn" class="btn">Create</button>
          <button id="cancel-create" class="btn ghost">Cancel</button>
        </div>
      `
      modal.style.display='flex'
      const nameInput = document.getElementById('new-name')
      const previewName = document.getElementById('name-preview')
      nameInput.addEventListener('input',()=>{ previewName.textContent = nameInput.value.replace(/\s+/g,'_') })
      document.getElementById('cancel-create').addEventListener('click',()=>modal.style.display='none')
      document.getElementById('create-server-btn').addEventListener('click',()=>{
        const name = document.getElementById('new-name').value.trim().replace(/\s+/g,'_')
        const version = document.getElementById('new-version').value
        if(!name.match(/^[A-Za-z0-9_\-]+$/)){ alert('invalid name (use letters, numbers, _ or -)'); return }
        // create server object
        const id = Math.random().toString(36).slice(2,9)
        const port = 19000 + Math.floor(Math.random()*3000)
        const server = {id,name,owner:state.user.username,version,texture:'',npcs:[],mods:[],port,created:Date.now(),running:false,gamerules:{keepInventory:false},gamemode:'survival',logs:[]}
        state.servers.push(server)
        saveState(); modal.style.display='none'; renderServers(); openPanel(id)
      })
    }

    modal.addEventListener('click',(e)=>{ if(e.target===modal) modal.style.display='none' })

    function renderServers(){
      const list = state.servers.filter(s=>state.user && s.owner===state.user.username)
      serversEl.innerHTML = ''
      serverCount.textContent = list.length
      if(list.length===0){ serversEl.innerHTML = '<div class="card small">No servers yet — create one!</div>'; return }
      list.forEach(s=>{
        const div = document.createElement('div'); div.className='server-item'
        div.innerHTML = `
          <div class="server-meta"><div class="server-name">${s.name}</div><div class="small">${s.version} · ${s.running?'<span style="color:#6ee7b7">running</span>':'stopped'}</div></div>
          <div style="display:flex;gap:8px;align-items:center">
            <button class="btn ghost" data-id="${s.id}" data-action="open">Open</button>
            <button class="btn" data-id="${s.id}" data-action="copy">Copy</button>
          </div>
        `
        serversEl.appendChild(div)
      })
      // attach listeners
      serversEl.querySelectorAll('button').forEach(btn=>{
        btn.addEventListener('click',()=>{
          const id = btn.getAttribute('data-id')
          const act = btn.getAttribute('data-action')
          if(act==='open') openPanel(id)
          if(act==='copy'){ const s = state.servers.find(x=>x.id===id); navigator.clipboard?.writeText(`127.0.0.1:${s.port}`); alert('Copied IP:PORT to clipboard') }
        })
      })
    }

    function openPanel(id){
      const s = state.servers.find(x=>x.id===id)
      if(!s) return
      state.selected = s.id; saveState()
      serverPanel.style.display='block'
      panelName.textContent = s.name
      panelSub.textContent = `Owner: ${s.owner} · Created: ${new Date(s.created).toLocaleString()}`
      panelId.textContent = s.id
      panelPort.textContent = s.port
      panelPortEl.textContent = s.port
      panelIdEl.textContent = s.id
      // version select
      panelVersion.innerHTML = VERSIONS.map(v=>`<option value="${v}" ${v===s.version?'selected':''}>${v}</option>`).join('')
      panelTexture.value = s.texture||''
      gamemodeEl.value = s.gamemode || 'survival'
      keepInvEl.value = s.gamerules?.keepInventory? 'true':'false'
      renderNpcList(s)
      modsArea.value = (s.mods||[]).map(m=>JSON.stringify(m)).join('\n')
      preview.innerHTML = s.logs.slice(-20).map(l=>`<div class="small">${l}</div>`).join('')
      startStopBtn.textContent = s.running ? 'Stop' : 'Start'
    }

    function hidePanel(){ serverPanel.style.display='none'; state.selected=null }

    addNpcBtn.addEventListener('click',()=>{
      const name = npcNameInput.value.trim()||'NPC'
      const s = state.servers.find(x=>x.id===state.selected); if(!s) return
      s.npcs.push({id:Math.random().toString(36).slice(2,9),name,buttons:[{label:'Hello',action:'/say hi'}]})
      s.logs.push(`[${new Date().toLocaleTimeString()}] NPC ${name} added`)
      saveState(); renderNpcList(s); previewLog(s)
      npcNameInput.value=''
    })

    function renderNpcList(s){ npcList.innerHTML=''; s.npcs.forEach(n=>{
      const div = document.createElement('div'); div.className='npc'
      div.innerHTML = `<div><strong>${n.name}</strong><div class="small">${n.buttons.map(b=>b.label).join(', ')}</div></div><div style="display:flex;gap:6px"><button class="btn ghost" data-act="edit" data-id="${n.id}">Edit</button><button class="btn ghost" data-act="del" data-id="${n.id}">Delete</button></div>`
      npcList.appendChild(div)
    })
      npcList.querySelectorAll('button').forEach(b=>b.addEventListener('click',()=>{
        const id=b.getAttribute('data-id'); const act=b.getAttribute('data-act'); const s = state.servers.find(x=>x.id===state.selected)
        const idx = s.npcs.findIndex(x=>x.id===id)
        if(act==='del'){ s.npcs.splice(idx,1); s.logs.push(`[${new Date().toLocaleTimeString()}] NPC deleted`); saveState(); renderNpcList(s); previewLog(s); return }
        if(act==='edit'){
          // simple edit modal
          modalBody.innerHTML = `
            <h3>Edit NPC</h3>
            <div class="field"><label>Name</label><input id="npc-edit-name" value="${s.npcs[idx].name}" /></div>
            <div class="field"><label>Buttons (comma separated labels)</label><input id="npc-edit-btns" value="${s.npcs[idx].buttons.map(b=>b.label).join(', ')}"/></div>
            <div style="display:flex;gap:8px"><button id="save-npc" class="btn">Save</button><button id="cancel-npc" class="btn ghost">Cancel</button></div>
          `
          modal.style.display='flex'
          document.getElementById('cancel-npc').addEventListener('click',()=>modal.style.display='none')
          document.getElementById('save-npc').addEventListener('click',()=>{
            const nn = document.getElementById('npc-edit-name').value.trim()||'NPC'
            const btns = document.getElementById('npc-edit-btns').value.split(',').map(x=>x.trim()).filter(Boolean)
            s.npcs[idx].name = nn
            s.npcs[idx].buttons = btns.map(l=>({label:l,action:''}))
            s.logs.push(`[${new Date().toLocaleTimeString()}] NPC ${nn} edited`)
            saveState(); modal.style.display='none'; renderNpcList(s); previewLog(s)
          })
        }
      }))
    }

    saveModsBtn.addEventListener('click',()=>{
      const s = state.servers.find(x=>x.id===state.selected); if(!s) return
      const lines = modsArea.value.split('\n').map(l=>l.trim()).filter(Boolean)
      s.mods = []
      for(const l of lines){ try{ s.mods.push(JSON.parse(l)) }catch(e){ alert('invalid JSON in mods'); return } }
      s.logs.push(`[${new Date().toLocaleTimeString()}] Mods updated (${s.mods.length})`)
      saveState(); previewLog(s); alert('mods saved')
    })
    clearModsBtn.addEventListener('click',()=>{ const s = state.servers.find(x=>x.id===state.selected); if(!s) return; s.mods=[]; modsArea.value=''; s.logs.push(`[${new Date().toLocaleTimeString()}] Mods cleared`); saveState(); previewLog(s) })

    startStopBtn.addEventListener('click',()=>{
      const s = state.servers.find(x=>x.id===state.selected); if(!s) return
      s.running = !s.running
      s.logs.push(`[${new Date().toLocaleTimeString()}] Server ${s.running? 'started':'stopped'}`)
      saveState(); renderServers(); openPanel(s.id)
    })

    deleteServerBtn.addEventListener('click',()=>{
      if(!confirm('Delete this server?')) return
      const idx = state.servers.findIndex(x=>x.id===state.selected)
      state.servers.splice(idx,1); state.selected=null; saveState(); renderServers(); hidePanel()
    })

    panelVersion.addEventListener('change',()=>{ const s = state.servers.find(x=>x.id===state.selected); if(!s) return; s.version = panelVersion.value; s.logs.push(`[${new Date().toLocaleTimeString()}] Version changed to ${s.version}`); saveState(); renderServers(); openPanel(s.id) })
    panelTexture.addEventListener('change',()=>{ const s = state.servers.find(x=>x.id===state.selected); if(!s) return; s.texture = panelTexture.value; s.logs.push(`[${new Date().toLocaleTimeString()}] Texture set`); saveState(); previewLog(s) })
    saveSettingsBtn.addEventListener('click',()=>{ const s = state.servers.find(x=>x.id===state.selected); if(!s) return; s.gamemode = gamemodeEl.value; s.gamerules.keepInventory = keepInvEl.value==='true'; s.logs.push(`[${new Date().toLocaleTimeString()}] Settings updated`); saveState(); previewLog(s); alert('settings saved') })

    function previewLog(s){ preview.innerHTML = s.logs.slice(-30).map(l=>`<div class="small">${l}</div>`).join('') }

    // import/export
    document.getElementById('export-btn').addEventListener('click',()=>{ const dump = {users:JSON.parse(localStorage.getItem('mbsc_users')||'[]'),state:state}; const blob = new Blob([JSON.stringify(dump, null, 2)],{type:'application/json'}); const url=URL.createObjectURL(blob); const a=document.createElement('a'); a.href=url; a.download='mbsc_export.json'; a.click(); URL.revokeObjectURL(url) })
    document.getElementById('import-btn').addEventListener('click',()=>{
      const inp = document.createElement('input'); inp.type='file'; inp.accept='.json'; inp.onchange = e=>{
        const f = e.target.files[0]; if(!f) return; const r=new FileReader(); r.onload=ev=>{
          try{ const data = JSON.parse(ev.target.result); if(data.users) localStorage.setItem('mbsc_users',JSON.stringify(data.users)); if(data.state) { state = data.state; saveState(); renderServers(); renderAuth(); hidePanel(); } alert('import complete') }catch(err){ alert('invalid file') }}; r.readAsText(f)
      }; inp.click()
    })

    // On load
    loadState()
  </script>
</body>
</html>
